---
layout:     post                        # 使用的布局（不需要改）
title:      关于Ubuntu上的nginx的安装               # 标题
subtitle:        # 副标题
date:       2019-12-25                 # 时间
author:     AhogeK                      # 作者
header-img: http://q1zffbfjd.bkt.clouddn.com/what-is-nginx.png     # 这篇文章标题背景图片
catalog: true                           # 是否归档
tags:                                   # 标签
    - nginx
    - ubuntu
---
>最近业余时间，开始回到最初大学生活那样开始自己做起小项目，但距离上一次已经过去蛮久了，现在刚进入社会工作，主要的任务也只是写好交给自己的业务模块，没有太多关于底层的东西。记得上一次自己写项目还是SSH + JSP的形式写的项目，虽然这两个东西基本不记得多少了【苦笑】而这次想用公司用的 Spring Boot 框架开发。因为前后端分离，也因此我需要给我自己的前端项目添加运行的服务器，而我就选择了Nginx，之前公司的项目也是用这个。

原先自己电脑上有安装过我就想着再装一个，就有了windows系统的上的思维，我能放一万个ngix ---- 事实我错了

因为上次是通过指令安装，因此这次就通过源码包（源码包！我一开始竟然想象成那种解压即用的形式！！！！）

[下载地址（.tar.gz）](http://nginx.org/download/)

上面的网站可以下载到tar包，现在的版本号可在[普通下载地址上看](http://nginx.org/en/download.html) 一般用稳定版即 *Stable version*

可以直接网站上下载，也可以 `wget`

下载完使用 ``tar -zxvf`` 解压 可以加上 -C 到指定路径

随后进入该路径

执行 ``./configure`` (路径下的一个可执行脚本)

但在这一部前我漏下重要的一件事，依赖包！！！

#### Nginx - error: HTTP rewrite module requires the PCRE library

执行 configure 前必须要确认两个依赖包，这里报错的是 PCRE 但其实还有个 ZLIB

```
sudo apt-get install libpcre3 libpcre3-dev
sudo apt-get install zlib1g-dev
```

只有有了这两个依赖才可以正常使用 configure 脚本

执行完这一步文件夹下会生成一个Makefile

我们只需 make  再  make install 即可如果有错误记得加 sudo

到这一步我们大致就安装完毕

但我们并不可以使用 ``systemctl`` 指令来操作 nginx ，它只有操作到我们 install下来的nginx 也就是 etc下的那个

而要运行这个nginx，我们就要去 /usr/local/nginx 下的 sbin/nginx启动脚本启动，坑人的是我不知道怎么关闭，我尝试 ``lsof -i:运行端口`` 还是 ``pa -ef | grep nginx`` 我都觉得不好把空，kill 进程还发生了注销wwwww

网上的大大们都会自己写个启动脚本 做软连接 就可以直接 nginx start/stop/restart操作，但我觉得我还是习惯了systemctl

我觉定重装，使用 install

#### 重装问题

这里一定要删除干净，不然不能有效重装

```shell
sudo apt-get remove nginx nginx-common # 卸载删除除了配置文件以外的所有文件。
 
sudo apt-get purge nginx nginx-common # 卸载所有东东，包括删除配置文件。
 
sudo apt-get autoremove # 在上面命令结束后执行，主要是卸载删除Nginx的不再被使用的依赖包。
```

最好在卸载干净的前提下再使用 ``sudo apt-get install nginx`` 进行安装

<hr>

*参考文章*

* [Ubuntu下安装与卸载Nginx](https://www.cnblogs.com/iamjqy/p/7443665.html)
* [linux后台运行和关闭、查看后台任务](https://www.cnblogs.com/kaituorensheng/p/3980334.html)
* [ubuntu下nginx安装手记](https://www.iteye.com/blog/staratsky-1758636)
* [记一次安装nginx遇到的问题](https://www.jianshu.com/p/7ce8fa5775cb)
* [Nginx - error: HTTP rewrite module requires the PCRE library](https://www.digizol.com/2017/08/nginx-error-http-rewrite-module.html)
* [Ubuntu 16.04安装Nginx](https://www.cnblogs.com/EasonJim/p/7806879.html)
* [关于linux复制、删除、移动文件及文件夹](https://blog.csdn.net/foreverlikui/article/details/78854075)
* [Ubuntu下Nginx安装](https://www.jianshu.com/p/7cb1a824333e)