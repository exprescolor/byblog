---
layout:     post
title:      电商金融类网站漏洞测试点
subtitle:   Web渗透测试
date:       2018-11-07
author:     黄秋豪
header-img: img\post-bg-ios9-web.jpg
catalog: true
tags:
    - 渗透测试
    - 电商金融类 
	- 漏洞测试点 

---

本次主要以P2P类金融和电商网站为研究对象，因为这类网站的模块多，参数多，数据多，所以刚上手时不太熟悉，经过几次渗透测试和实际项目经验后，对这类网站有了些大体的渗透流程和思路。对于模块：需要对模块进行拆分，比如先测试登陆模块再测试订单模块在测试支付模块；对于参数：要确定这个参数在当前页面的作用，需要不断去尝试比对发现，从而确定进行测试；对于数据：在测试中有些抓到链接中的数据是无用的，需要对每个数据进行测试删除无用数据，再进行测试，避免对正常测试产生干扰。下面我对此类网站整理出一下逻辑漏洞测试点。

登陆
||暴力破解用户名密码
||撞库
||验证码爆破和绕过
||手机号撞库
||账户权限绕过

注册
||恶意用户批量注册
||恶意验证注册账户
||存储型XSS"

密码找回
||重置任意用户账户密码
||批量重置用户密码
||新密码劫持
||短信验证码劫持
||用户邮箱劫持篡改"

购买支付
||商品金额篡改
||商品数量篡改
||交易信息泄漏"

充值
||虚假充值金额
||充值数量篡改
||篡改充值账户
 
抽奖/活动
||刷取活动奖品
||盗刷积分
||抽奖作弊"

代金卷/优惠卷
||批量刷取代金卷/优惠卷
||更改代金卷金额
||更改优惠卷数量"
	
	
订单
||订单信息泄漏
||用户信息泄漏
||订单遍历
	
账户
||账户绕过
||账户余额盗取
||账户绑定手机号绕过"

会员系统	
||用户越权访问
||个人资料信息泄漏
||个人资料遍历"
	
传输过程	
||COOKIE注入
||COOKIE跨域
||COOKIE劫持
明文传输

评论	
||POST注入
||CSRF
||存储型XSS
||遍历用户名

公告
||SSRF内网探测


登陆/后台绕过大多采用账号密码爆破，对于一些商城，应用，政府，学校则采用撞库方式判断是否存在该账号（需要准备各类字典：手机号撞库，邮箱撞库，姓名撞库）
撞库/暴力破解位置：登陆处/获取验证码登陆处

||框架漏洞：需要手动测试web框架类型，在进行POC。
||用户名枚举/暴力破解：猜测账号密码，需要百家姓字典和密码字典，实际渗透中如果对方开启了几次验证和WAF，此方法只可以手动进行。
||更改登陆标识：抓包更改验证标识（http  200/ok 1或者0，需开启BP回应包选项），如果更改后无法登陆则无法登陆。
||未授权登陆：站点爬行spride-target，查看目录结构，尝试访问。
||查询是否有数据库端口：一般大企业走内网，不会暴露过多信息，可以尝试。


范例：撞库/枚举/绕过结合漏洞
撞库：
漏洞URL：
https://xxx.xxx.com.cn/xxx/auth/loginSubmit.action

数据包：
POST /xxx/xxx/loginSubmit.action HTTP/1.1
Host: xxx.xxx.com.cn
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
x-requested-with: XMLHttpRequest


userName=test&passWord=8450e5b41cdc3d300d139c0733265164620ff2676ed1d6bcd83025c49a091e143e0d1b11c3aba9ee9e13c4ced9d3182c3368d85a9e3e1b7a5533900a00e82d341ab10efe1282b80b307f10cca117ccbdc2c493

用户账号不存在，显示账号不存在。























