---
layout:     post                        # 使用的布局（不需要改）
title:      Java8中的日期时间类              # 标题
subtitle:   
date:       2019-12-8                 # 时间
author:     AhogeK                      # 作者
header-img: img/home-bg.jpg     # 这篇文章标题背景图片
catalog: true                           # 是否归档
tags:                                   # 标签
    - 学习笔记
    - Java8
    - 日期时间类
---
### Java8中的日期时间类

Java 8的日期和时间类包含 ``LocalDate``、``LocalTime``、``Instant``、``Duration``以及 ``Period``，这些类都包含在 ``java.time`` 包中。

#### LocalDate 和 LocalTime

``LocalDate`` 类表示一个具体的日期，但不包含具体时间，也不包含时区信息。可以通过 ``LocalDate`` 的静态方法 ``of()`` 创建一个实例，``LocalDate`` 也包含一些方法用来获取年份，月份，天，星期几等：

```java
LocalDate localDate = LocalDate.of(2019, 12, 8);     // 初始化一个日期：2019-12-08
int year = localDate.getYear();                     // 年份：2019
Month month = localDate.getMonth();                 // 月份：DECEMBER
int dayOfMonth = localDate.getDayOfMonth();         // 月份中的第几天：8
DayOfWeek dayOfWeek = localDate.getDayOfWeek();     // 一周的第几天：SUNDAY
int length = localDate.lengthOfMonth();             // 月份的天数：31
boolean leapYear = localDate.isLeapYear();          // 是否为闰年：false
```

也可以调用静态方法now()来获取当前日期：

``LocalDate now = LocalDate.now();``

``LocalTime`` 和 ``LocalDate`` 类似，他们之间的区别在于 ``LocalDate`` 不包含具体时间，而 ``LocalTime`` 包含具体时间，例如：

```java
LocalTime localTime = LocalTime.of(17, 23, 52);     // 初始化一个时间：17:23:52
int hour = localTime.getHour();                     // 时：17
int minute = localTime.getMinute();                 // 分：23
int second = localTime.getSecond();                 // 秒：52
```

#### LocalDateTime

``LocalDateTime`` 类是 ``LocalDate`` 和 ``LocalTime`` 的结合体，可以通过 ``of()`` 方法直接创建，也可以调用 ``LocalDate`` 的 ``atTime()`` 方法或 ``LocalTime`` 的 ``atDate()`` 方法将 ``LocalDate`` 或 ``LocalTime`` 合并成一个 ``LocalDateTime``： 

```java
LocalDateTime ldt1 = LocalDateTime.of(2019, Month.DECEMBER, 8, 17, 23, 52);
LocalDate localDate = LocalDate.of(2019, Month.DECEMBER, 8);
LocalTime localTime = LocalTime.of(17, 23, 52);
LocalDateTime ldt2 = localDate.atTime(localTime);
```

``LocalDateTime`` 也提供用于向 ``LocalDate`` 和 ``LocalTime`` 的转化：

```java
LocalDate date = ldt1.toLocalDate();
LocalTime time = ldt1.toLocalTime();
```

#### Instant

``Instant`` 用于表示一个时间戳，它与我们常使用的 ``System.currentTimeMillis()`` 有些类似，不过 ``Instant`` 可以精确到纳秒（Nano-Second），``System.currentTimeMillis()`` 方法只精确到毫秒（Milli-Second）。如果查看Instant源码，发现它的内部使用了两个常量，seconds表示从1970-01-01 00:00:00开始到现在的秒数，nanos表示纳秒部分（nanos的值不会超过999,999,999）。Instant除了使用 ``now()`` 方法创建外，还可以通过 ``ofEpochSecond`` 方法创建：

``Instant instant = Instant.ofEpochSecond(120, 100000);``

``ofEpochSecond()`` 方法的第一个参数为秒，第二个参数为纳秒，上面的代码表示从*1970-01-01 00:00:00* 开始后两分钟的10万纳秒的时刻，控制台上的输出为：

``1970-01-01T00:02:00.000100Z``

#### Duration

``Duration`` 的内部实现与 ``Instant`` 类似，也是包含两部分：``seconds`` 表示秒，``nanos``表示纳秒。两者的区别是 ``Instant`` 用于表示一个时间戳（或者说是一个时间点），而 ``Duration`` 表示一个时间段，所以 ``Duration`` 类中不包含 ``now()`` 静态方法。可以通过 ``Duration.between()`` 方法创建 ``Duration`` 对象：

```java
LocalDateTime from = LocalDateTime.of(2019, Month.JANUARY, 5, 10, 7, 0);    // 2019-01-05 10:07:00
LocalDateTime to = LocalDateTime.of(2019, Month.FEBRUARY, 5, 10, 7, 0);     // 2019-02-05 10:07:00
Duration duration = Duration.between(from, to);     // 表示从 2019-01-05 10:07:00 到 2019-02-05 10:07:00 10:07:00 这段时间

long days = duration.toDays();              // 这段时间的总天数
long hours = duration.toHours();            // 这段时间的小时数
long minutes = duration.toMinutes();        // 这段时间的分钟数
long seconds = duration.getSeconds();       // 这段时间的秒数
long milliSeconds = duration.toMillis();    // 这段时间的毫秒数
long nanoSeconds = duration.toNanos();      // 这段时间的纳秒数
```

``Duration`` 对象还可以通过 ``of()`` 方法创建，该方法接受一个时间段长度，和一个时间单位作为参数：

```java
Duration duration1 = Duration.of(5, ChronoUnit.DAYS);       // 5天
Duration duration2 = Duration.of(1000, ChronoUnit.MILLIS);  // 1000毫秒
```

#### Period

``Period`` 在概念上和 ``Duration`` 类似，区别在于 ``Period`` 是以年月日来衡量一个时间段，比如2年3个月6天：

``Period period = Period.of(2, 3, 6);``

``Period`` 对象也可以通过 ``between()`` 方法创建，值得注意的是，由于 ``Period`` 是以年月日衡量时间段，所以 ``between()`` 方法只能接收 ``LocalDate`` 类型的参数：

```java
// 2019-01-05 到 2019-02-05 这段时间
Period period = Period.between(
                LocalDate.of(2019, 1, 5),
                LocalDate.of(2019, 2, 5));

```