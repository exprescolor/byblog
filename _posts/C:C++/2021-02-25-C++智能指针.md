---
layout:     post
title:      C++智能指针
date:       2021-02-25
author:     Yukun SHANG
catalog: 	 true
tags:
    - C/C++
---



# C++智能指针

c++中一共有四个智能指针: 

* auto_ptr
* shared_ptr
* weak_ptr
* unique_ptr 

其中后三个是c++11支持，auto_ptr已经被c++11弃用。

### 智能指针的意义

相比于Java，C++的内存管理显得不是那么“智能”， 因为C++中new一个对象，需要程序员手动去delete。但是有时候程序一复杂，跳转一多，就可能不能及时地去释放资源，导致内存泄露。

C++的智能指针可以有效地解决上述问题。智能指针会自动调用析构函数，实现自动释放资源。



### 来自牛客网的参考答案

智能指针主要用于管理在堆上分配的内存，它将普通的指针封装为一个栈对象。当栈对象的生存周期结束后，会在析构函数中释放掉申请的内存，从而防止内存泄漏。C++ 11中最常用的智能指针类型为shared_ptr,它采用引用计数的方法，记录当前内存资源被多少个智能指针引用。该引用计数的内存在堆上分配。当新增一个时引用计数加1，当过期时引用计数减一。只有引用计数为0时，智能指针才会自动释放引用的内存资源。对shared_ptr进行初始化时不能将一个普通指针直接赋值给智能指针，因为一个是指针，一个是类。可以通过make_shared函数或者通过构造函数传入普通指针。并可以通过get函数获得普通指针。