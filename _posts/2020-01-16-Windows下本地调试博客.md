---
layout:     post
title:      Windows下本地调试博客
subtitle:   基于GitHub Pages + Jekyll 创建的个人博客
date:       2020-01-16
author:     DR
header-img: img/post-bg-universe.jpg
catalog: true
tags:
    - 本地调试
    - Github
---



<!-- more -->
> 本文为 Jekyll 搭建的个人博客在 Windows 环境下的调试配置，以及可能会面临的一些问题，列出了一点解决方法及可行性建议。

> 本文内容非原创，整理了[Windows本地调试个人博客](https://zong-min.github.io/2019/06/08/Windows%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/)以及[Windows下本地配置Jekyll](https://2heng.xin/2017/06/05/jekyll/)。
<!-- more -->



# 1. 调试前准备
#### 1.1. 安装 Ruby + DevKit

```Ruby 3.0``` 之后 ```Ruby``` 和``` DevKit``` 已经集成为一个软件，[点此进入官网下载](https://rubyinstaller.org/downloads/)。
按照您的电脑系统，选择**With DevKit**项下的最新版，我的电脑是64位，则：
![Ruby_Devkit安装图](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147207_20200116093043140_19789.png)


安装路径尽量选非系统盘，路径名中不要使用中文与空格，英文名为宜。
![Ruby_Devkit安装1](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147212_20200116095522583_30.png)


![Ruby_Devkit安装2](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147213_20200116100116585_15595.png)

验证此步成功与否，可以在命令行中分别输入```gem -v```以及```ruby -v```，回显版本号，即安装成功

#### 1.2. 使用gem安装Jekyll
- 此过程需要**科学上网**以及耐心(或者换切换gem源到国内镜像，例如```https://gems.ruby-china.com```)

- 打开一个```Terminal```输入```gem install Jekyll```,耐心等待即可

- 输入```Jekyll -v```确认安装完成


# 2. 启动调试

- 使用[Github Desktop](https://desktop.github.com/)(建议)克隆你的博客项目到本地(如果没有博客，fork一个他人的或者新建一个)

![clone博客项目](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147215_20200116102111356_22454.png )

- 进入你博客所在的文件夹，打开配置文件``` _config.yml```，找到 ```gems: [jekyll-paginate]``` 这句语句，并将其改成 ```plugins: [jekyll-paginate]```
- 然后执行命令```> gem install jekyll-paginate```

- 成功后将工作目录切换到你clone的根目录下( 例如我的就是```C://Users/Null/Desktop/destinyenvoy.github.io```）,然后运行命令```> jekyll s```，然后理论上就OK了，可以在浏览器```https://127.0.0.1:4000```查看博客了。


# 3. 可能面临问题

#### 3.1. post.html与page.html有关的警告

若出现如下警告![post.html与page.html有关警告](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147217_20200116103636792_24815.png )

- 解决方式

​ 在 ```_layouts```下的```post.html```与```page.html```中，找到 ```&&``` 替换成``` and```，找到``` site.featured-condition-size``` 将它的双重大括号去掉。

#### 3.2. 文件夹下文件名不能兼容中文


- 修改目录```E:\Ruby27-x64\lib\ruby\2.7.0\webrick\httpservlet``` 下的 ```filehandler.rb``` 文件，添加``` UTF-8``` 编码语句：
```rb
path = req.path_info.dup.force_encoding(Encoding.find("filesystem"))
path.force_encoding("UTF-8")  
if trailing_pathsep?(req.path_info)
```
```rb
break if base == "/"
base.force_encoding("UTF-8")   
break unless File.directory?(File.expand_path(res.filename + base))
```

#### 3.3. 本地4000端口被占用


- 若出现以下问题
![本地4000端口被占用](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147222_20200116104820416_4323.png)
- 解决方式
   - cmd中输入```netstat -ano```查看端口占用情况
    ![端口占用](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147224_20200116110851560_21725.png)
   - 可以看到4000端口被一个PID=5824的程序占用，继续揪出来，输入```tasklist /svc /FI "PID eq 5824"```看到
    ![占用服务查看](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147226_20200116111105832_10589.png)
   - 打开任务管理器->服务->FxService，右键干掉，完美收工。


# 4. 更新博客

在本地```https://127.0.0.1:4000/```编辑与调试好博客之后，就可以push到github上了


![使用GithubDesktop更新个人博客](https://raw.githubusercontent.com/DestinyEnvoy/Githubimg/master/1579147229_20200116115456190_26948.png)



---

# ```Reference```
>
> 1. [Windows本地调试个人博客](https://zong-min.github.io/2019/06/08/Windows%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/)
> 2. [Windows下本地配置Jekyll](https://2heng.xin/2017/06/05/jekyll/)