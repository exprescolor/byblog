---
title: 监控体系
subtitle:  某公司监控的落地实践总结
date: 2019-11-04
header-img: img/123.jpg
catalog: true
tags: Prometheus
---

#### 想要做的
* 及时发现当前系统中存在的问题，而不依赖人的反馈，提高服务SLA
* 分析当前业务系统负载状态，及时扩容缩容，减少资源成本
* 收集线上数据，为服务优化，缩短响应时长提供准确数据支持，优化用户体验
* 通过技术手段，为公司决策层提供可供参考的日报周报月报

#### 怎样做到
* 落地一整套监控，对系统不间断实时监控，反馈系统当前状态，有问题及时报警
* Dev团队在自身程序上做的数据埋点
* 完整的日志收集策略和统一的日志格式

#### 方案选择

| Feature      | Consul               | zookeeper           |etcd           |euerka           |
| -------------|--------------------- |---------------------|---------------|-----------------|
| 服务健康检查 |服务状态，内存，硬盘等|(弱)长连接，keepalive|连接心跳       |可配支持         |
| 多数据中心   |支持                  |—                    |—              |—                |
| kv存储服务   |支持                  |支持                 |支持           |—                |
| 一致性       |raft                  |paxos                |raft           |—                |
| 使用接口     |支持http和dns         |客户端               |http/grpc      |http             |
| watch支持    |全量/支持long polling |支持                 |支持longpolling|支持longpolling  |
| 自身监控     |metrics               |—                    |metrics        |metrics          |
| 安全         |acl/https             |acl                  |https支持（弱）|—                |
| SpringCloud  |支持                  |支持                 |支持           |支持             |
























