---
layout:     post   				    # 使用的布局（不需要改）
title:       reverse junior math			# 标题 
#subtitle:   脚本，xss #副标题
date:       2020-03-16 				# 时间
author:     s-seven 						# 作者
header-img: img/post-bg-2015.jpg 	#这篇文章标题背景图片
catalog: true 						# 是否归档
tags:								#标签
    - CTF
---

这两天做了两道reverse的题，思路差不多，捋一捋第二道题

# 逆向工具ida

静态分析工具：ida

动态调试工具：OD,windbg,CE等

so，我们这里拿到的文件应该用ida来打开

关于ida的使用，csdn的这篇博客有简要说明：

> https://blog.csdn.net/xiangshangbashaonian/article/details/82748850>

安装和更详细的使用指南可移步吾爱破解论坛

# junior math

我们把rev2拖到ida里，提示这是一个ELF文件，OK，一会可能要去虚拟机验证

ida打开文件之后，F5可看到main函数的代码：

![5.jpg](http://ww1.sinaimg.cn/large/005KQQDely1gcw561q81wj30j60ewgmk.jpg)

__isoc99_scanf是不限制长度输入，我们可以看到这个函数让你输入一串字符串，接下来执行了14个函数，最后验证dword_602064的值来输出正误。

![7.jpg](http://ww1.sinaimg.cn/large/005KQQDely1gcw5baabenj30bu0khwfr.jpg)

代码窗口的左边可以选择函数进入，于是我们看一下第一个sub函数

![6.jpg](http://ww1.sinaimg.cn/large/005KQQDely1gcw5cf8g9yj30rq072wex.jpg)

同时看一下我们输入的这个字符串

![5.jpg](http://ww1.sinaimg.cn/large/005KQQDely1gcw5er1o77j30vk0i7tbh.jpg)



我们输入的字符串开始地址为602080，一共16位，而十四个函数每个函数的功能都一样，拿出字符串的某一位和它的下下位，进行操作之后进行或运算，这样除了开头两个字节和结尾两个字节，中间14个字节都进行了两遍运算，如果每次函数的结果都为ture，那么我们最后判断602064的时候就会输出right，即输入字符串正确。

那么函数功能理清之后，我们就要找到使最终结果正确的这个16位的字符串，很容易想到这也应该是我们要找的flag。

于是憨憨开始手算。。。。

我写了一个函数来解一元二次方程，

```c++
#include<iostream>
using namespace std;
int main()
{
	int b, c;
	cin >> b >> c;
	int x = b*b-4*c;
	cout << (-b -sqrt(x)) / 2;
	return 0;
}
```

随便点开一个函数，让或运算为真，即

(byte_602080 - 147) * byte_602080 != -4590

要解得2080这一位的字符，将b=-147和c=4590带入到一元二次方程，解得这一位字符的十进制码，对照ASCII码表来获得这一位字符，依次计算，最后得到这16位字符串。

我们来到Linux虚拟机，打开文件来验证一下算得的字符串


题目是解出来了，但是感觉后半部分做的有点。。。憨憨的，一时半会又想不起编码解决的办法，改日再回来看看这道题
