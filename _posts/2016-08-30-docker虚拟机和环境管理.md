---
layout:     post
title:      docker虚拟机和环境管理
subtitle:   docker and virtualBox
date:       2016-08-30
author:     Nico
header-img: img/post_bg_11.jpg
catalog:      true
tags:
    - docker
    - virtualBox
    - linux
---

## virtualBox
### 什么是virtualBox
mac下的开源虚拟机，功能和主流的vm没有什么差别，主要看中的是开源免费而且占用空间小。和vagrant一起使用可以很方便的创建linux开发环境，也可以载入windows镜像使用windows虚拟机；

- virtualBox安装：https://www.virtualbox.org/
- virtualBox官方文档：https://www.virtualbox.org/manual/UserManual.html

### 什么是docker
> Docker是一个开源的引擎，可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署，包括VMs（虚拟机）、bare metal、OpenStack 集群和其他的基础应用平台。

其实没太懂，应该是一个类似vagrant里不同box的较小的封装程序，里面自带平台和系统来自给自足的供程序运行? 再研究下～ mark

一个docker web开发的实例： https://github.com/kasperisager/php-dockerized.git

### docker和虚拟机有什么不同
vagrant开发者何docker开发者的论战：http://www.cnblogs.com/vikings-blog/p/3973265.html
## vagrant

### 什么是vagrant
引用别人的话：

> vagrant实际上一套虚拟机管理工具，基于Ruby开发，底层支持VirtualBox、VMware甚至AWS、docker等作为虚拟化系统。我们可以通过 Vagrant 封装一个 Linux 的开发环境，分发给团队成员。成员可以在自己喜欢的桌面系统（Mac/Windows/Linux）上开发程序，代码却能统一在封装好的环境里运行，“代码在我机子上运行没有问题”这种说辞将成为历史。



> vagrant 的主要意义是让所有开发人员都使用和线上服务器一样的环境，本质上和你新建一个虚拟机，然后发给所有的同事是一样的，vagrant 只是简单地帮你自动化这个过程，比如 vagrant 可以通过一个配置文件来生成一个虚拟机，在本地和虚拟机之间共享文件，把一个虚拟机分享给别人等等。一般情况下我们是用 Command-Line 来控制 vagrant 的，通过 Command-Line 控制的好处就是可以自动化、脚本化。

总结一下vagrant的好处其实是解决了
1. 团队多个程序员之间共享程序的时候由于自己计算机的编译环境不一样而导致的程序错误，就是说在团队协作的时候作用最大，
然后也有其他优点，比如：
2. 支持命令行创建虚拟机，可以脚本化
3. 支持修改vagrantFile来调整参数，操作简单
4. 有很多开源的box可以下载，box里面集成安装了很多开发环境
5. 对有洁癖和强迫症的开发人员可以高效管理自己的不同虚拟机

作为一个伪开发＋数据分析师，我觉得这货应该主要还是给我用来学习web development, 高效管理自己的linux的开发环境有用。

### 安装和文档
- vagrant安装：https://www.vagrantup.com/downloads.html
- vagrant文档：http://tangbaoping.github.io/vagrant_doc_zh/v2/
### 初始化
1. 创建一个vagrant文件夹

```shell
mkdir vagrant_folder
cd vagrant_folder
```

2. vagrant init 初始化并自动创建一个Vagrantfile配置文件

```shell
vagrant init
```

3. 创建一个虚拟机

```shell
vagrant box add hashicorp/precise64 ## 名为hashicorp/precise64的linux box被下载安装了
```

4. 启动虚拟机

```shell
vagrant up
```

5. 链接虚拟机

```shell
vagrant ssh
```

6. 然后就进入linux环境了。。。。

之后每次打开只要cd到对应的vagrant_folder文件夹然后vagrant up，再 vagrant ssh就可以了

### 常用命令
- vagrant box list: 查看当前安装的虚拟机
- vagrant suspend：休眠当前的虚拟机
- vagrant halt: 关机
- vagrant destroy：删掉虚拟机
- vagrant reload: 从Vagrantfile中重启虚拟机（不知道什么应用场景）
- vagrant global-status 输出所有虚拟机当前运行的状态
### 参考文件和高阶应用

- Vagrant搭建虚拟化开发环境: http://www.jianshu.com/p/3c3f35436c05
- 在 Mac/win7 下上使用 Vagrant 打造本地开发环境： https://segmentfault.com/a/1190000002645737
- 如何制作一个vagrant的basebox: http://blog.csdn.net/samxx8/article/details/38943395
