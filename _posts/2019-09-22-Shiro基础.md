---
layout:     post 
title:      Shiro基础0922
subtitle:   实现授权Realm
date:       2019-09-22
author:     张鹏
header-img: img/post-bg-YesOrNo.jpg
catalog: true   
tags:                         
    - Shiro
---

#### 实现授权Realm
- 实现步骤

1. 从PrincipalCollection中来获取登陆用户的信息
2. 利用登录的用户信息来获取当前用户的角色或权限（可能需要查询数据库）
3. 创建SimpleAuthorizationInfo，并设置其roles属性
4. 返回SimpleAuthorizationInfo对象

- ShiroRealm.java


```java
	@Override
	protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) {
		//1.从PrincipalCollection中来获取登陆用户的信息
		Object principal=principals.getPrimaryPrincipal();
		//2.利用登录的用户信息来获取当前用户的角色或权限（可能需要查询数据库）
		Set<String> roles=new HashSet<>();
		roles.add("user");
		if ("admin".equals(principal)) {
			roles.add("admin");
		}
		//3.创建SimpleAuthorizationInfo，并设置其roles属性
		SimpleAuthorizationInfo info = new SimpleAuthorizationInfo(roles);
		//4.返回SimpleAuthorizationInfo对象
		return info;
	}
```

- 实现结果：用户输入的用户名是admin时，可以访问adminpage和userpage；用户输入的用户名是user时，只能访问userpage